import{d as M2,t as A,a as k,s as o,c as V2}from"../chunks/cdZpXTRU.js";import{X as k2,a2 as w,a0 as a,$ as s,Z as q,_ as D2,j as e,a3 as p,a4 as a2,a1 as t,T as Z2,Y as s2}from"../chunks/CpheGI1x.js";import{p as m,i as r2}from"../chunks/lS090TL_.js";import{e as l2,i as c2}from"../chunks/B8U8OScr.js";import{A as n2,t as o2,f as p2,p as R2}from"../chunks/DmQUckAG.js";import{c as i2}from"../chunks/Ej25J0qn.js";const j2="data:image/svg+xml,%3csvg%20width='23'%20height='23'%20viewBox='0%200%2023%2023'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M21.25%2015C20.9186%2015.0005%2020.601%2015.1324%2020.3667%2015.3667C20.1324%2015.601%2020.0005%2015.9186%2020%2016.25V19.25C19.9995%2019.4488%2019.9203%2019.6392%2019.7797%2019.7797C19.6392%2019.9203%2019.4488%2019.9995%2019.25%2020H3.25C3.05125%2019.9995%202.86079%2019.9203%202.72025%2019.7797C2.57971%2019.6392%202.50053%2019.4488%202.5%2019.25V16.25C2.5%2015.9185%202.3683%2015.6005%202.13388%2015.3661C1.89946%2015.1317%201.58152%2015%201.25%2015C0.918479%2015%200.600537%2015.1317%200.366117%2015.3661C0.131696%2015.6005%200%2015.9185%200%2016.25V19.25C0.00105851%2020.1116%200.343808%2020.9377%200.953072%2021.5469C1.56234%2022.1562%202.38837%2022.4989%203.25%2022.5H19.25C20.1116%2022.4989%2020.9377%2022.1562%2021.5469%2021.5469C22.1562%2020.9377%2022.4989%2020.1116%2022.5%2019.25V16.25C22.4995%2015.9186%2022.3676%2015.601%2022.1333%2015.3667C21.899%2015.1324%2021.5814%2015.0005%2021.25%2015Z'%20fill='%23191D22'/%3e%3cpath%20d='M11.2491%200C10.9177%200.000528905%2010.6001%200.132395%2010.3658%200.366701C10.1315%200.601007%209.99962%200.918642%209.99909%201.25V12.581L6.04909%209.29C5.79434%209.07817%205.46596%208.97606%205.136%209.00605C4.80605%209.03605%204.50147%209.19571%204.28909%209.45C4.07726%209.70475%203.97515%2010.0331%204.00514%2010.3631C4.03514%2010.693%204.1948%2010.9976%204.44909%2011.21L10.4491%2016.21C10.5121%2016.2547%2010.579%2016.2935%2010.6491%2016.326C10.6948%2016.3566%2010.7426%2016.384%2010.7921%2016.408C10.9363%2016.4687%2011.0911%2016.5%2011.2476%2016.5C11.404%2016.5%2011.5589%2016.4687%2011.7031%2016.408C11.7514%2016.3839%2011.7981%2016.3569%2011.8431%2016.327C11.9131%2016.2945%2011.9801%2016.2556%2012.0431%2016.211L18.0431%2011.211C18.2403%2011.047%2018.3823%2010.8262%2018.4497%2010.5787C18.5172%2010.3312%2018.5069%2010.0689%2018.4202%209.82751C18.3335%209.58608%2018.1746%209.37717%2017.9651%209.22913C17.7556%209.08109%2017.5056%209.0011%2017.2491%209C16.9568%209.00055%2016.6738%209.10312%2016.4491%209.29L12.4991%2012.581V1.25C12.4986%200.918642%2012.3667%200.601007%2012.1324%200.366701C11.8981%200.132395%2011.5804%200.000528905%2011.2491%200Z'%20fill='%23191D22'/%3e%3c/svg%3e",q2="data:image/svg+xml,%3csvg%20width='82'%20height='82'%20viewBox='0%200%2082%2082'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M81.0352%2031.0268C81.0039%2030.9409%2080.9766%2030.8627%2080.9375%2030.7807C80.9102%2030.7182%2080.8985%2030.6518%2080.8633%2030.5893L71.4883%2013.5273C70.9375%2012.5273%2069.8867%2011.9062%2068.75%2011.9062H60.625V3.125C60.625%201.3984%2059.2266%200%2057.5%200H23.75C22.0234%200%2020.625%201.3984%2020.625%203.125V11.9062H12.5C11.3594%2011.9062%2010.3086%2012.5273%209.76171%2013.5273L0.386714%2030.5893C0.351557%2030.6479%200.343745%2030.7182%200.312495%2030.7807C0.273433%2030.8627%200.246089%2030.9448%200.214839%2031.0268C0.097649%2031.351%200.0195287%2031.6909%200.0117188%2032.0307C0.0117188%2032.0541%200%2032.0698%200%2032.0971V65.4411C0%2067.1677%201.3984%2068.5661%203.125%2068.5661H8.9023L5.6757%2077.0153C5.30851%2077.9762%205.43742%2079.0544%206.01945%2079.902C6.60148%2080.7497%207.56635%2081.2536%208.59365%2081.2536L72.2496%2081.2575C73.273%2081.2575%2074.2262%2080.7575%2074.8121%2079.9216C75.3981%2079.0857%2075.5348%2078.0154%2075.1832%2077.0544L72.0777%2068.57H78.1246C79.8512%2068.57%2081.2496%2067.1716%2081.2496%2065.445V32.097C81.2496%2032.0736%2081.2379%2032.0579%2081.2379%2032.0306C81.2301%2031.6908%2081.1524%2031.351%2081.0352%2031.0268ZM26.8752%206.2538H54.3752V19.3158H26.8752V6.2538ZM14.3522%2018.1598H20.6256V19.316H20.0943C18.3677%2019.316%2016.9693%2020.7144%2016.9693%2022.441C16.9693%2024.1676%2018.3677%2025.566%2020.0943%2025.566H61.1563C62.8829%2025.566%2064.2813%2024.1676%2064.2813%2022.441C64.2813%2020.7144%2062.8829%2019.316%2061.1563%2019.316H60.6251V18.1598H66.8985L72.8399%2028.9718H8.40589L14.3473%2018.1598H14.3522ZM13.1334%2075.0038L20.3404%2056.1598H60.8794L64.6567%2066.5118C64.6645%2066.5313%2064.6801%2066.5431%2064.684%2066.5626L67.7699%2075.004L13.1334%2075.0038ZM75.0004%2062.3158H69.7895L67.5356%2056.1596C69.2583%2056.1596%2070.6567%2054.7612%2070.6567%2053.0346C70.6567%2051.308%2069.2583%2049.9096%2067.5317%2049.9096H63.0708H63.063H18.188H18.1802H13.7193C11.9927%2049.9096%2010.5943%2051.308%2010.5943%2053.0346C10.5943%2054.7338%2011.9576%2056.1049%2013.649%2056.144L11.2857%2062.312H6.24656V35.222H75.0006L75.0004%2062.3158Z'%20fill='%23191D22'/%3e%3cpath%20d='M17.4453%2042.5674C17.4453%2046.7354%2011.1953%2046.7354%2011.1953%2042.5674C11.1953%2038.3994%2017.4453%2038.3994%2017.4453%2042.5674Z'%20fill='%23191D22'/%3e%3c/svg%3e";var A2=(D,x)=>x(-1),B2=(D,x)=>x(1),I2=(D,x,B)=>x(e(B).id),N2=A('<li class="table--item svelte-pe8xtc"><button class="svelte-pe8xtc"><p class="date svelte-pe8xtc"> </p> <p class="number svelte-pe8xtc"> </p> <p class="number svelte-pe8xtc"> </p> <p class="number short svelte-pe8xtc"> </p> <p class="number short svelte-pe8xtc"> </p> <p class="number svelte-pe8xtc"> </p> <p class="number svelte-pe8xtc"> </p></button></li>'),U2=A('<li class="table--item svelte-pe8xtc"><p class="text svelte-pe8xtc"> </p> <p class="number short svelte-pe8xtc"> </p> <p class="number svelte-pe8xtc"> </p> <p class="number svelte-pe8xtc"> </p> <p class="number svelte-pe8xtc"> </p></li>'),Y2=A('<p class="title"> </p> <div class="table svelte-pe8xtc"><div class="table--header svelte-pe8xtc"><p class="text svelte-pe8xtc">producto</p> <p class="svelte-pe8xtc">cantidad</p> <p class="svelte-pe8xtc">importe</p> <p class="svelte-pe8xtc">desc</p> <p class="svelte-pe8xtc">p. prom</p></div> <ul class="table--body svelte-pe8xtc"><!></ul> <div class="buttonRow svelte-pe8xtc"><!> <!></div></div>',1),E2=A('<main class="page svelte-pe8xtc"><div class="table-wrapper list svelte-pe8xtc"><div class="table--month svelte-pe8xtc"><p class="title">Reportes</p> <div class="month svelte-pe8xtc"><button class="svelte-pe8xtc">-</button> <div class="text svelte-pe8xtc"><p class="title svelte-pe8xtc"> </p> <p class="year svelte-pe8xtc"> </p></div> <button class="svelte-pe8xtc">+</button></div></div> <div class="table svelte-pe8xtc"><div class="table--header svelte-pe8xtc"><p class="date svelte-pe8xtc">fecha</p> <p class="number svelte-pe8xtc">importe</p> <p class="number svelte-pe8xtc">desc.</p> <p class="number short svelte-pe8xtc">tickets</p> <p class="number short svelte-pe8xtc">canc.</p> <p class="number svelte-pe8xtc">tarjeta</p> <p class="number svelte-pe8xtc">efectivo</p></div> <ul class="table--body"></ul></div></div> <div class="table-wrapper details svelte-pe8xtc"><!></div></main>');function X2(D,x){k2(x,!0);let B=x.data,Z=w(m(B.sales)),v=w(m({}));m(new Date);const R=new Date,v2=R.getMonth(),d2=R.getFullYear();let d=w(m(R.getMonth())),f=w(m(R.getFullYear())),u2=Z2(()=>new Date(e(f),e(d)).toLocaleString("es",{month:"long"})),_=w(!1),C=w(!1);async function X(l){if(!(e(d)+l>v2&&e(f)===d2)){p(d,e(d)+l),e(d)<0?(p(d,11),a2(f,-1)):e(d)>11&&(p(d,0),a2(f));try{const n=await(await fetch(`/api/sale/month?date=${new Date(e(f),e(d),1)}`)).json();return p(Z,m(n.sales)),console.log("sales: ",e(Z)),{sales:e(Z)}}catch{console.error("No sales")}}}function m2(l,r){const c=new Blob([r],{type:"application/json"}),n=document.createElement("a");n.href=URL.createObjectURL(c),n.download=l,document.body.appendChild(n),n.click(),document.body.removeChild(n)}async function x2(l){try{const c=await(await fetch(`/api/sale/${l}`)).json();console.log("show sale: ",c),p(v,m(c))}catch(r){console.error("no sale by id",r)}}async function _2(l){if(e(_)){p(C,!1),p(_,!1);return}if(e(C))try{const n=(await(await fetch(`/api/sale/export?id=${l}`)).json()).encryptedSale,u=`chibi-SUC-${e(v).date}.enc.json`;m2(u,n)}catch(r){console.error("error exporting: ",r)}else p(C,!0)}async function C2(){if(e(C)){p(C,!1),p(_,!1);return}if(e(_)){e(v),R2.ip;try{await window.api.printSale(JSON.parse(JSON.stringify(e(v)))),p(_,!1)}catch(l){console.error("error printing sale: ",l)}}else p(_,!0)}var I=E2(),N=a(I),U=a(N),z=s(a(U),2),G=a(z);G.__click=[A2,X];var Y=s(G,2),E=a(Y),h2=a(E,!0);t(E);var K=s(E,2),f2=a(K,!0);t(K),t(Y);var b2=s(Y,2);b2.__click=[B2,X],t(z),t(U);var Q=s(U,2),W=s(a(Q),2);l2(W,21,()=>e(Z),c2,(l,r)=>{var c=N2(),n=a(c);n.__click=[I2,x2,r];var u=a(n),H=a(u,!0);t(u);var L=s(u,2),F=a(L,!0);t(L);var b=s(L,2),j=a(b,!0);t(b);var S=s(b,2),i=a(S,!0);t(S);var g=s(S,2),O=a(g,!0);t(g);var M=s(g,2),h=a(M,!0);t(M);var y=s(M,2),V=a(y,!0);t(y),t(n),t(c),q(T=>{o(H,T),o(F,e(r).net_sales),o(j,e(r).discount_amount),o(i,e(r).ticket_count),o(O,e(r).canceled_count),o(h,e(r).card),o(V,e(r).cash)},[()=>new Date(e(r).date).toLocaleDateString("en-ES",{day:"numeric",month:"short",year:"numeric",timeZone:"UTC"})]),k(l,c)}),t(W),t(Q),t(N);var e2=s(N,2),g2=a(e2);{var y2=l=>{var r=Y2(),c=s2(r),n=a(c,!0);t(c);var u=s(c,2),H=s(a(u),2),L=a(H);{var F=i=>{var g=V2(),O=s2(g);l2(O,17,()=>e(v).daily_sales_details,c2,(M,h)=>{var y=U2(),V=a(y),T=a(V,!0);t(V);var $=s(V,2),w2=a($,!0);t($);var J=s($,2),H2=a(J,!0);t(J);var P=s(J,2),L2=a(P,!0);t(P);var t2=s(P,2),S2=a(t2,!0);t(t2),t(y),q(()=>{o(T,e(h).product.name),o(w2,e(h).quantity),o(H2,e(h).net_sales),o(L2,e(h).discount_amount),o(S2,e(h).av_price)}),k(M,y)}),k(i,g)};r2(L,i=>{e(v).id&&i(F)})}t(H);var b=s(H,2),j=a(b);n2(j,{action:C2,imgSrc:q2,imgAlt:"imprimir",readyImg:i2,readyAlt:"confirmar",flexBasis:"50%",get ready(){return e(_)},set ready(i){p(_,m(i))}});var S=s(j,2);n2(S,{action:()=>_2(e(v).id),imgSrc:j2,imgAlt:"exportar",readyImg:i2,readyAlt:"confirmar",flexBasis:"50%",get ready(){return e(C)},set ready(i){p(C,m(i))}}),t(b),t(u),q(i=>o(n,i),[()=>new Date(e(v).date).toLocaleDateString("en-ES",{day:"numeric",month:"short",year:"numeric",timeZone:"UTC"})]),o2(1,c,()=>p2,()=>({y:30,duration:500})),o2(1,u,()=>p2,()=>({y:30,duration:500})),k(l,r)};r2(g2,l=>{e(v).id&&l(y2)})}t(e2),t(I),q(()=>{o(h2,e(u2)),o(f2,e(f))}),k(D,I),D2()}M2(["click"]);export{X2 as component};
